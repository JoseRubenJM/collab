{"ast":null,"code":"/*!\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nexport function combine(combiningInfo, currentValue, newValue, seq) {\n  if (currentValue === undefined) {\n    currentValue = combiningInfo.defaultValue;\n  }\n  // Fixed set of operations for now\n  /* eslint-disable default-case */\n  switch (combiningInfo.name) {\n    case \"incr\":\n      currentValue += newValue;\n      if (combiningInfo.minValue) {\n        if (currentValue < combiningInfo.minValue) {\n          currentValue = combiningInfo.minValue;\n        }\n      }\n      break;\n    case \"consensus\":\n      if (currentValue === undefined) {\n        const cv = {\n          value: newValue,\n          seq\n        };\n        currentValue = cv;\n      } else {\n        const cv = currentValue;\n        if (cv.seq === -1) {\n          cv.seq = seq;\n        }\n      }\n      break;\n  }\n  /* eslint-enable default-case */\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n  return currentValue;\n}\nexport function matchProperties(a, b) {\n  if (a) {\n    if (!b) {\n      return false;\n    } else {\n      // For now, straightforward; later use hashing\n      // eslint-disable-next-line no-restricted-syntax\n      for (const key in a) {\n        if (b[key] === undefined) {\n          return false;\n        } else if (typeof b[key] === \"object\") {\n          if (!matchProperties(a[key], b[key])) {\n            return false;\n          }\n        } else if (b[key] !== a[key]) {\n          return false;\n        }\n      }\n      // eslint-disable-next-line no-restricted-syntax\n      for (const key in b) {\n        if (a[key] === undefined) {\n          return false;\n        }\n      }\n    }\n  } else {\n    if (b) {\n      return false;\n    }\n  }\n  return true;\n}\nexport function extend(base, extension, combiningOp, seq) {\n  if (extension !== undefined) {\n    if (typeof extension !== \"object\") {\n      console.log(`oh my ${extension}`);\n    }\n    // eslint-disable-next-line guard-for-in, no-restricted-syntax\n    for (const key in extension) {\n      const v = extension[key];\n      if (v === null) {\n        // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n        delete base[key];\n      } else {\n        if (combiningOp && combiningOp.name !== \"rewrite\") {\n          base[key] = combine(combiningOp, base[key], v, seq);\n        } else {\n          base[key] = v;\n        }\n      }\n    }\n  }\n  return base;\n}\nexport function clone(extension) {\n  if (extension === undefined) {\n    return undefined;\n  }\n  const cloneMap = createMap();\n  // eslint-disable-next-line guard-for-in, no-restricted-syntax\n  for (const key in extension) {\n    const v = extension[key];\n    if (v !== null) {\n      cloneMap[key] = v;\n    }\n  }\n  return cloneMap;\n}\nexport function addProperties(oldProps, newProps, op, seq) {\n  if (!oldProps || op && op.name === \"rewrite\") {\n    oldProps = createMap();\n  }\n  extend(oldProps, newProps, op, seq);\n  return oldProps;\n}\nexport function extendIfUndefined(base, extension) {\n  if (extension !== undefined) {\n    if (typeof extension !== \"object\") {\n      console.log(`oh my ${extension}`);\n    }\n    // eslint-disable-next-line no-restricted-syntax\n    for (const key in extension) {\n      if (base[key] === undefined) {\n        base[key] = extension[key];\n      }\n    }\n  }\n  return base;\n}\n// Create a MapLike with good performance.\nexport function createMap() {\n  const map = Object.create(null);\n  // Using 'delete' on an object causes V8 to put the object in dictionary mode.\n  // This disables creation of hidden classes, which are expensive when an object is\n  // constantly changing shape.\n  // eslint-disable-next-line dot-notation\n  map[\"__\"] = undefined;\n  // eslint-disable-next-line dot-notation, @typescript-eslint/no-dynamic-delete\n  delete map[\"__\"];\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n  return map;\n}\n//# sourceMappingURL=properties.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}